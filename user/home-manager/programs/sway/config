# Read `man 5 sway` for a complete reference.

#
# Variables
#
# set $CONFIG_DIR "$HOME/.config/sway"
# set $SCRIPTS    "$HOME/scripts"

# set $OUTPUT-LAPTOP 'eDP-1'

# set $mod   Mod4
# set $left  h
# set $down  j
# set $up    k
# set $right l

# set $term          'alacritty --working-directory ~'
# set $floating-term "alacritty --class 'floating-term' --working-directory ~"
# set $quake-term    "alacritty --class 'quake-term' --working-directory ~"
# set $menu          'xfce4-appfinder --replace'
# set $menu-wofi     'wofi --fork --show drun,run'
# set $explorer      "alacritty --class 'file-explorer' --title 'ranger' -e ranger ~"
# set $gui-explorer  'nautilus'
# set $browser       'dex ~/.local/share/applications/firefox.desktop'
# set $alt-browser   'qutebrowser'
# set $lock          'swaylock -f -c 0f0f0ff0 -i ~/Pictures/wallpaper/3840x2160.png'
# set $logout        'wlogout'
# set $audiocontrol  'pavucontrol'

# set $ws1  "1: Browsing"
# set $ws2  "2: School"
# set $ws3  "3: Dev"
# set $ws4  "4: Sysadmin"
# set $ws5  "5: Games"
# set $ws6  "6: Videos"
# set $ws7  "7: social"
# set $ws8  "8:"
# set $ws9  "9:"
# set $ws10 "10:"

#
# Basic settings
#

gaps inner 5
smart_gaps on
smart_borders no_gaps
hide_edge_borders --i3 smart_no_gaps

#font Fira Sans 9, "Noto Color Emoji" 9
font Fira Sans 9

default_border pixel 3
default_floating_border pixel 1

workspace_layout default
workspace_auto_back_and_forth no

# Drag floating windows by holding down $mod and left mouse button.
# Resize them with right mouse button + $mod.
# Despite the name, also works for non-floating windows.
# Change normal to inverse to use left mouse button for resizing and right
# mouse button for dragging.
floating_modifier $mod normal
#floating_minimum_size 400 x 300


# Load user config
include "$CONFIG_DIR/config.d/*"
include "$CONFIG_DIR/window-rules.d/*"




#
# Laptop specific settings
#
bindswitch --locked lid:on  output $OUTPUT-LAPTOP disable
bindswitch --locked lid:off output $OUTPUT-LAPTOP enable
bindsym --locked $mod+Shift+F12 output $OUTPUT-LAPTOP toggle


### Key bindings
#
# Basics:
#
# Start a terminal
bindsym $mod+Shift+Return exec $floating-term
bindsym $mod+Return       exec $term

# Kill focused window
bindsym $mod+Shift+d kill
#bindsym --release button2 kill

# Start the launcher
bindsym $mod+p  exec $menu
bindsym $mod+d  exec $menu-wofi
bindsym Alt+Tab exec "rofi -show-icons -show window"

# Lock
bindsym $mod+Backspace       exec $lock
bindsym $mod+Ctrl+Backspace  exec $logout

# Toggle border
bindsym $mod+c border toggle

# Reload the configuration file
bindsym $mod+Shift+c exec "$SCRIPTS/sway-reload.sh"

# Exit sway (logs out of Wayland session)
bindsym $mod+Shift+q exec swaynag -t warning -e bottom -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -b 'Yes, exit sway' 'swaymsg exit'

# Restart sway
bindsym $mod+Shift+r exec swaynag -t warning -e bottom -m 'You pressed the restart shortcut. Do you really want to restart sway?' -b 'Yes, restart sway' 'swaymsg restart'

# Volume
bindsym --locked XF86AudioRaiseVolume exec "$SCRIPTS/volume.sh" 'increase'
bindsym --locked XF86AudioLowerVolume exec "$SCRIPTS/volume.sh" 'decrease'
bindsym --locked XF86AudioMute        exec "$SCRIPTS/volume.sh" 'toggle-mute'
bindsym --locked XF86AudioMicMute     exec "$SCRIPTS/volume.sh" 'mic-mute'

# Brightness
bindsym --locked XF86MonBrightnessUp   exec 'brightnessctl set +10%'
bindsym --locked XF86MonBrightnessDown exec 'brightnessctl --min-value=30 set 10%-'

# Screenshot
bindsym --release Print       exec "$SCRIPTS/screenshot.sh" 'selection'
bindsym --release Mod1+Print  exec "$SCRIPTS/screenshot.sh" 'window'
bindsym --release Shift+Print exec "$SCRIPTS/screenshot.sh" 'screen'
bindsym --release Ctrl+Print  exec "$SCRIPTS/screenshot.sh" 'everything'

# Paste primary selection
#bindsym --release ralt+backslash exec wl-paste --primary
#bindsym --release shift+insert   exec wl-paste --primary

# Open explorer
bindsym XF86Explorer     exec $gui-explorer
bindsym $mod+Slash       exec $gui-explorer
bindsym $mod+Shift+Slash exec $explorer

# Open default browser
bindsym $mod+n exec $browser
# Open alternative browser
bindsym $mod+shift+n exec $alt-browser

# MPRIS
bindsym --locked XF86AudioPause exec playerctl pause
bindsym XF86AudioPlay  exec playerctl play

# Toggle play/pause for the active mpris instance
# Use pause-break to toggle
bindsym --locked Pause exec playerctl play-pause


#
# Moving around:
#
# Move your focus around
bindsym $mod+$left  focus left
bindsym $mod+$down  focus down
bindsym $mod+$up    focus up
bindsym $mod+$right focus right

# Move the focused window
bindsym $mod+Shift+$left  move left
bindsym $mod+Shift+$down  move down
bindsym $mod+Shift+$up    move up
bindsym $mod+Shift+$right move right

# Move to next monitor
bindsym $mod+Ctrl+$left  move window to output left
bindsym $mod+Ctrl+$down  move window to output down
bindsym $mod+Ctrl+$up    move window to output up
bindsym $mod+Ctrl+$right move window to output right


#
# Workspaces and output:
#
# switch to workspace
bindsym $mod+i       workspace prev_on_output
bindsym $mod+o       workspace next_on_output

# focus output
bindsym $mod+Shift+i focus output left
bindsym $mod+Shift+o focus output right

#bindsym $mod+Ctrl+i move window to workspace

bindsym $mod+u       workspace back_and_forth
bindsym $mod+Shift+u move container to workspace back_and_forth

bindsym $mod+Tab exec "$SCRIPTS/sway-switch-workspace.sh"

bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $ws1;
bindsym $mod+Shift+2 move container to workspace $ws2;
bindsym $mod+Shift+3 move container to workspace $ws3;
bindsym $mod+Shift+4 move container to workspace $ws4;
bindsym $mod+Shift+5 move container to workspace $ws5;
bindsym $mod+Shift+6 move container to workspace $ws6;
bindsym $mod+Shift+7 move container to workspace $ws7;
bindsym $mod+Shift+8 move container to workspace $ws8;
bindsym $mod+Shift+9 move container to workspace $ws9;
bindsym $mod+Shift+0 move container to workspace $ws10;
bindsym $mod+Ctrl+1  move container to workspace $ws1;  workspace $ws1
bindsym $mod+Ctrl+2  move container to workspace $ws2;  workspace $ws2
bindsym $mod+Ctrl+3  move container to workspace $ws3;  workspace $ws3
bindsym $mod+Ctrl+4  move container to workspace $ws4;  workspace $ws4
bindsym $mod+Ctrl+5  move container to workspace $ws5;  workspace $ws5
bindsym $mod+Ctrl+6  move container to workspace $ws6;  workspace $ws6
bindsym $mod+Ctrl+7  move container to workspace $ws7;  workspace $ws7
bindsym $mod+Ctrl+8  move container to workspace $ws8;  workspace $ws8
bindsym $mod+Ctrl+9  move container to workspace $ws9;  workspace $ws9
bindsym $mod+Ctrl+0  move container to workspace $ws10; workspace $ws10

# Adapted from https://github.com/swaywm/sway/issues/
# Move workspace to other screens
bindsym $mod+Shift+w exec alacritty --class 'floating-term' --command bash "$SCRIPTS/sway_move_workspace_to_screen.sh"
# Move workspace to another screen
bindsym $mod+Alt+w exec "$SCRIPTS/sway_move_workspace_to_other_screen.sh"

#
# Layout stuff:
#
# You can "split" the current object of your focus with
# $mod+b or $mod+v, for horizontal and vertical splits
# respectively.
bindsym $mod+b splith
bindsym $mod+v splitv

# Switch the current container between different layout styles
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Make the current focus fullscreen and inhibit idle while focused
bindsym $mod+f fullscreen, inhibit_idle focus
bindsym $mod+shift+f fullscreen global, inhibit_idle focus

# Toggle the current focus between tiling and floating mode
bindsym $mod+Shift+space floating toggle

# Swap focus between the tiling area and the floating area
bindsym $mod+space focus mode_toggle

# move focus to the parent container
bindsym $mod+a focus parent
# move focus to the child container
bindsym $mod+z focus child

# Sticky focused window
bindsym $mod+Shift+s sticky toggle


#
# Scratchpad:
#
# Sway has a "scratchpad", which is a bag of holding for windows.
# You can send windows there and get them back later.

# Move the currently focused window to the scratchpad
bindsym $mod+Shift+minus move scratchpad

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym $mod+minus scratchpad show

#
# Resizing containers:
#
mode "resize" {
    # left will shrink the containers width
    # right will grow the containers width
    # up will shrink the containers height
    # down will grow the containers height
    bindsym $left  resize shrink width  10px
    bindsym $down  resize grow   height 10px
    bindsym $up    resize shrink height 10px
    bindsym $right resize grow   width  10px
    bindsym Shift+$left  resize shrink width  50px
    bindsym Shift+$down  resize grow   height 50px
    bindsym Shift+$up    resize shrink height 50px
    bindsym Shift+$right resize grow   width  50px

    # return to default mode
    bindsym Return mode default
    bindsym Escape mode default
}
bindsym $mod+r mode "resize"

#
# Changing the gap between screens
#
mode "gaps" {
    # Preset 1: Reset
    bindsym 1 mode default;\
        gaps inner current set 0;\
        gaps outer current set 0
    # Preset 2: Inner 5; Outer 10
    bindsym 2 mode default;\
        gaps inner current set 10;\
        gaps outer current set 0

    # Complete gap
    bindsym Plus       gaps inner current plus 5
    bindsym Underscore gaps inner current minus 5
    bindsym Equal      gaps outer current plus 5
    bindsym Minus      gaps outer current minus 5

    # Individually increase the gap for each direction
    bindsym $left  gaps left  current plus 5
    bindsym $right gaps right current plus 5
    bindsym $down  gaps down  current plus 5
    bindsym $up    gaps up    current plus 5
    # Inverse
    bindsym Shift+$left  gaps left  current minus 5
    bindsym Shift+$right gaps right current minus 5
    bindsym Shift+$down  gaps down  current minus 5
    bindsym Shift+$up    gaps up    current minus 5

    # return to default mode
    bindsym Return mode default
    bindsym Escape mode default
}
bindsym $mod+g mode "gaps"


# Move a specific window/container
mode "multimedia" {
    bindsym left  exec playerctl previous;
    bindsym right exec playerctl next;
    bindsym up    exec playerctl play-pause;

    # return to default mode
    bindsym Return mode default
    bindsym Escape mode default
    bindsym $mod+m mode default
}
bindsym $mod+m mode "multimedia"


# Focus a specific window
mode "execute/focus" {
    # Spotify
    bindsym s [class="Spotify"] focus; mode default

    bindsym r noop
    # Riot
    bindsym r+i [class="Riot"] focus; mode default
    # RocketChat
    bindsym r+c [class="Rocket.Chat" instance="rocket.chat"] focus; mode default
    # Lollypop (Gnome music player)
    bindsym l [app_id="lollypop"] focus; mode default
    # Thunderbird (email)
    bindsym t [class="Thunderbird" instance="Mail"] focus; mode default
    # Bitwarden
    bindsym b [class="Bitwarden" instance="bitwarden"] focus; mode default
    # Messenger (Caprine)
    bindsym m [class="Caprine" instance="caprine"] focus; mode default


    # Restart waybar
    bindsym F12 exec 'systemctl --user is-active --quiet waybar.service && systemctl --user restart waybar.service'; \
      mode default

    # Launch volume controller
    bindsym c exec $audiocontrol; mode default

    # return to default mode
    bindsym Return mode default
    bindsym Escape mode default
}
bindsym $mod+x mode "execute/focus"
